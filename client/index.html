<html>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.slim.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    $(() => {
      var socket = io('http://localhost:3000');

      let timer = null
      socket.on('k-ramel/action', action => {
        switch (action.type) {
          case '@@game/ping': {
            console.log(`ping ! [${Date.now() - timer}, ${Date.now() - action.payload}]`)
            timer = null
            break
          }
          default: {
            console.log(action.type, action)
            break
          };
        }
      })

      setInterval(() => {
        if (timer === null) {
          timer = Date.now()
          socket.emit('k-ramel/action', { type: '@@game/ping' })
        }
      }, 1000)
    });
  </script>
</html>
